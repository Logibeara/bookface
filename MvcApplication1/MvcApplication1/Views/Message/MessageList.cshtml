
@using MvcApplication1.Models
@model MvcApplication1.Models.Message
@{
    Layout = null;
    var i = 0;
    var messageList = ViewData["Messages"] as List<Message>;
} 

@{foreach( Message m in messageList) {
      
<div class="list_box_class" @Html.Raw(String.Format("id=\"{0}\"", m.MessageID))>
    <table class="list_box_table">
   		<tr>
        <td style="width:50px">
      		<img class="thumbnail" src="~/Images/heroAccent.png">
   		</td>
        <td style="width:20px" id="Sender" class="sender">
            @m.SenderName
        </td>
             
        <td style="width:100px" id="TruncatedMessage" class="truncatedmessage">
        	@m.Message1
        </td>
               
        <td style="width:50px" id="IsRead" class="isread">
            @m.IsRead
        </td>
        <td style="width:50px"  id="SendDate" class="senddate">
        	@m.SendDate
        </td>
        </tr>
   </table>
</div>
<script>
    $(@Html.Raw(String.Format("'#{0}'", m.MessageID))).mousedown(function (event) {
        switch (event.which) {
            case 1: //LMB click
                $('#overlay_content').html('<progress max="100"></progress>');
                $('#overlay_parent').css('visibility', 'visible');
                $.post('./GetMessage', {id: @m.MessageID}, function(result){
                    $('#overlay_content').html(result);
                });
                break;
            case 3: //RMB click
                var w = window.open();
                $(w.document.body).html('<progress max="100"></progress>');
                $.post('./GetMessage',{id: @m.MessageID}, function(result){
                    $(w.document.body).html(result);
                });
                break;
            default: //not useful
                break;
        }
    });
</script>
  }
}